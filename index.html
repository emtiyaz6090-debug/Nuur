<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deen - Fully Working App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;600;700&display=swap');
        body { font-family: 'Hind Siliguri', sans-serif; background-color: #F8FAFC; color: #1E293B; }
        .header-gradient { background: linear-gradient(180deg, #3B4CC0 0%, #6366F1 100%); border-bottom-left-radius: 40px; border-bottom-right-radius: 40px; }
        .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 24px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .feature-icon { width: 55px; height: 55px; border-radius: 16px; display: flex; align-items: center; justify-content: center; transition: 0.2s; cursor: pointer; }
        .feature-icon:active { transform: scale(0.9); }
        .live-dot { height: 8px; width: 8px; background-color: #EF4444; border-radius: 50%; display: inline-block; margin-left: 5px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(0.95); } 70% { transform: scale(1.1); } 100% { transform: scale(0.95); } }
        .page { display: none; }
        .page.active { display: block; }
    </style>
</head>
<body class="max-w-md mx-auto min-h-screen pb-28">

    <div id="page-home" class="page active">
        <div class="header-gradient pt-8 pb-24 px-6 relative">
            <div class="flex justify-between items-center text-white mb-6">
                <button class="p-2 bg-white/20 rounded-full"><i class="fa-solid fa-bars"></i></button>
                <h1 class="text-xl font-bold">Deen - Islam</h1>
                <select id="manual-location" class="bg-indigo-800/50 text-[10px] rounded-full px-2 py-1 border-none text-white outline-none">
                    <option value="Dhaka">ঢাকা (Default)</option>
                    <option value="Chittagong">চট্টগ্রাম</option>
                    <option value="Sylhet">সিলেট</option>
                    <option value="Rajshahi">রাজশাহী</option>
                    <option value="Khulna">খুলনা</option>
                    <option value="Barisal">বরিশাল</option>
                </select>
            </div>

            <div class="flex justify-between items-end text-white/90">
                <div>
                    <p id="hijri-date" class="text-lg font-semibold font-sans">-- -- --</p>
                    <p id="gregorian-date" class="text-sm opacity-80">-- --- ----</p>
                </div>
                <div class="text-right">
                    <p id="location-name" class="text-sm font-medium"><i class="fa-solid fa-location-dot mr-1"></i> ঢাকা, বাংলাদেশ</p>
                    <button onclick="getLocation()" class="text-[10px] bg-white/20 px-2 py-1 rounded mt-1">GPS রিফ্রেশ</button>
                </div>
            </div>
        </div>

        <div class="px-5 -mt-16">
            <div class="glass-card p-6">
                <div class="flex justify-between">
                    <div>
                        <p class="text-indigo-600 font-bold text-sm">পরবর্তী নামাজ: <span id="next-prayer-name">--</span><span class="live-dot"></span></p>
                        <h2 id="next-prayer-time" class="text-5xl font-black text-indigo-950 my-2">--:--</h2>
                        <div class="flex space-x-4 mt-4">
                            <div class="bg-blue-50 px-3 py-2 rounded-xl">
                                <p class="text-[10px] uppercase text-blue-500 font-bold">সেহরি শেষ</p>
                                <p id="suhur-time" class="text-lg font-bold text-blue-900 font-sans">--:--</p>
                            </div>
                            <div class="bg-orange-50 px-3 py-2 rounded-xl">
                                <p class="text-[10px] uppercase text-orange-500 font-bold">ইফতার</p>
                                <p id="iftar-time" class="text-lg font-bold text-orange-900 font-sans">--:--</p>
                            </div>
                        </div>
                    </div>
                    <i class="fa-solid fa-mosque text-6xl text-indigo-900 opacity-10"></i>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-4 gap-4 px-5 mt-8">
            <div onclick="switchPage('quran')" class="flex flex-col items-center">
                <div class="feature-icon bg-blue-100 text-blue-600"><i class="fa-solid fa-book-quran text-xl"></i></div>
                <span class="text-xs font-bold">কুরআন</span>
            </div>
            <div onclick="switchPage('tasbih')" class="flex flex-col items-center">
                <div class="feature-icon bg-orange-100 text-orange-600"><i class="fa-solid fa-calculator text-xl"></i></div>
                <span class="text-xs font-bold">তাসবিহ</span>
            </div>
            <div onclick="switchPage('dua')" class="flex flex-col items-center">
                <div class="feature-icon bg-purple-100 text-purple-600"><i class="fa-solid fa-hand-holding-heart text-xl"></i></div>
                <span class="text-xs font-bold">দুয়া</span>
            </div>
            <div onclick="alert('কিবলা কম্পাস শীঘ্রই আসছে')" class="flex flex-col items-center">
                <div class="feature-icon bg-green-100 text-green-600"><i class="fa-solid fa-compass text-xl"></i></div>
                <span class="text-xs font-bold">কিবলা</span>
            </div>
        </div>
    </div>

    <div id="page-quran" class="page px-5 pt-8">
        <button onclick="switchPage('home')" class="mb-4 text-indigo-600"><i class="fa-solid fa-arrow-left"></i> হোম</button>
        <h2 class="text-2xl font-bold mb-4">আল কুরআন</h2>
        <div class="space-y-3">
            <div class="bg-white p-4 rounded-xl flex justify-between shadow-sm"><span>১. সুরা ফাতিহা</span><i class="fa-solid fa-play"></i></div>
            <div class="bg-white p-4 rounded-xl flex justify-between shadow-sm"><span>২. সুরা বাকারা</span><i class="fa-solid fa-play"></i></div>
        </div>
    </div>

    <div id="page-tasbih" class="page px-5 pt-12 text-center">
        <button onclick="switchPage('home')" class="mb-4 text-indigo-600 block text-left"><i class="fa-solid fa-arrow-left"></i> হোম</button>
        <h2 class="text-2xl font-bold mb-8">তাসবিহ কাউন্টার</h2>
        <div class="bg-white w-48 h-48 rounded-full mx-auto flex items-center justify-center shadow-xl border-8 border-indigo-50 mb-6">
            <span id="tasbih-count" class="text-6xl font-bold text-indigo-600 font-sans">0</span>
        </div>
        <button onclick="countTasbih()" class="w-full bg-indigo-600 text-white py-4 rounded-2xl text-xl font-bold shadow-lg active:scale-95 transition">সবহানাল্লাহ</button>
        <button onclick="resetTasbih()" class="mt-4 text-gray-400">রিসেট করুন</button>
    </div>

    <nav class="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white border-t flex justify-around items-center py-3 z-50 shadow-lg">
        <div onclick="switchPage('home')" class="flex flex-col items-center text-indigo-600 cursor-pointer">
            <i class="fa-solid fa-house text-xl"></i><span class="text-[10px] font-bold">হোম</span>
        </div>
        <div onclick="switchPage('quran')" class="flex flex-col items-center text-gray-400 cursor-pointer">
            <i class="fa-solid fa-book-open text-xl"></i><span class="text-[10px] font-bold">কুরআন</span>
        </div>
        <div onclick="switchPage('tasbih')" class="flex flex-col items-center text-gray-400 cursor-pointer">
            <i class="fa-solid fa-calculator text-xl"></i><span class="text-[10px] font-bold">তাসবিহ</span>
        </div>
    </nav>

    <script>
        // Tab Switching
        function switchPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
        }

        // Tasbih Logic
        let tCount = 0;
        function countTasbih() {
            tCount++;
            document.getElementById('tasbih-count').innerText = tCount;
        }
        function resetTasbih() {
            tCount = 0;
            document.getElementById('tasbih-count').innerText = tCount;
        }

        // Fetch Prayer Times
        async function fetchTimes(city, lat = null, lon = null) {
            let url = `https://api.aladhan.com/v1/timingsByCity?city=${city}&country=Bangladesh&method=1`;
            if (lat && lon) {
                url = `https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=1`;
            }

            try {
                const response = await fetch(url);
                const data = await response.json();
                const t = data.data.timings;

                // Update UI
                document.getElementById('suhur-time').innerText = t.Fajr;
                document.getElementById('iftar-time').innerText = t.Maghrib;
                document.getElementById('hijri-date').innerText = `${data.data.date.hijri.day} ${data.data.date.hijri.month.en} ${data.data.date.hijri.year}`;
                document.getElementById('gregorian-date').innerText = data.data.date.readable;
                
                updateNextPrayer(t);
            } catch (err) {
                console.error("Error fetching times");
            }
        }

        function updateNextPrayer(t) {
            const now = new Date();
            const currentMins = now.getHours() * 60 + now.getMinutes();
            
            const schedule = [
                { name: 'ফজর', time: t.Fajr },
                { name: 'যোহর', time: t.Dhuhr },
                { name: 'আসর', time: t.Asr },
                { name: 'মাগরিব', time: t.Maghrib },
                { name: 'এশা', time: t.Isha }
            ];

            let next = schedule[0];
            for (let p of schedule) {
                const [h, m] = p.time.split(':').map(Number);
                if ((h * 60 + m) > currentMins) {
                    next = p;
                    break;
                }
            }
            document.getElementById('next-prayer-name').innerText = next.name;
            document.getElementById('next-prayer-time').innerText = next.time;
        }

        // Location Logic
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        document.getElementById('location-name').innerText = "আমার লোকেশন";
                        fetchTimes(null, pos.coords.latitude, pos.coords.longitude);
                    },
                    () => {
                        alert("GPS এক্সেস পাওয়া যায়নি। ম্যানুয়াল লোকেশন ব্যবহার করুন।");
                        fetchTimes("Dhaka");
                    }
                );
            }
        }

        document.getElementById('manual-location').addEventListener('change', (e) => {
            document.getElementById('location-name').innerText = e.target.value + ", বাংলাদেশ";
            fetchTimes(e.target.value);
        });

        window.onload = () => fetchTimes("Dhaka");
    </script>
</body>
</html>
